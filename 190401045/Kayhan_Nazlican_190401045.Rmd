---
title: "Proje Rapor : Nazlican Kayhan 190401045"
output:
  html_document:
    df_print: paged
---

# Q1 : Problem tanımı

Yatırım Strateji Danışmanlık, tarımsal yatırımlar konusunda danışmanlık hizmeti sunan bir şirkettir. Müşterilerine, tarım sektöründe yatırım yapmak için en uygun bölgeleri ve ürünleri belirlemede yardımcı olma amacındadır. Ancak, şirketin tarımsal pazar ve ürün verimliliği konularında yeterli uzmanlığa sahip olmaması, müşterilere doğru ve verimli yatırım tavsiyeleri sunma kapasitesini sınırlıyor. Bu durum, hem müşteri memnuniyetini hem de şirketin gelir potansiyelini olumsuz yönde etkiliyor. Şirketin karşılaştığı ana sorun, çeşitli tarım ürünlerinin ve bölgelerin üretim ve pazar dinamiklerini etkin bir şekilde analiz ederek, müşterilere güvenilir ve karlı yatırım fırsatları sunabilecek bilgi birikimine ulaşmaktır.

# Q2 : Proje Amacı

[Global Food Prices](https://www.kaggle.com/datasets/jboysen/global-food-prices)

[World Food Production](https://www.kaggle.com/datasets/rafsunahmad/world-food-production)

Bu projenin amacı, tarımsal ürünlerin üretim verilerini analiz ederek yatırımcılara en uygun yatırım fırsatlarını sunmak ve böylece Yatırım Strateji Danışmanlık şirketinin müşteri memnuniyetini ve gelirlerini artırmaktır. Analiz aşamaları şunlardır:

Ürün ve Bölge Trend Analizi: Çeşitli tarım ürünlerinin geçmiş üretim verilerini inceleyerek, hangi ürünlerin üretiminin arttığını veya azaldığını belirlemek.
Pazar Talebi Tahmini: Geçmiş verilere dayanarak gelecekte hangi ürünlerin talep göreceğini tahmin etmek.
Bölgesel Verimlilik Analizi: Farklı bölgelerdeki üretim verimliliğini analiz ederek, hangi bölgelerin hangi ürünler için daha uygun olduğunu belirlemek.

# Q3 : Veri seti keşifsel analizi

```{r echo=FALSE, message=FALSE, warning=FALSE}

filename1 <- "wfp_market_food_prices.csv"
filename2 <- "world food production.csv"


library(readr)
prices_data <- read_csv(filename1)
production_data <- read_csv(filename2)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}

hist(prices_data$mp_year, breaks = 20)
head(prices_data)
dim(prices_data)
str(prices_data)
colSums(is.na(prices_data))

#unique(prices_data$adm0_name) # Ülkeler
#unique(prices_data$mkt_name)  # Pazarlar
#unique(prices_data$cm_name)   # Ürünler
summary(prices_data$mp_price) # Fiyatlar
table(prices_data$mp_month)   # Aylar
table(prices_data$mp_year)    # Yıllar


```


## "wfp_market_food_prices.csv" Veri Seti Analizi

**Genel Bakış:** Bu veri seti, 743,914 satır ve 18 sütundan oluşmaktadır. Ana sütunlar arasında ülke (adm0_name), pazar (mkt_name), ürün (cm_name), para birimi (cur_name), fiyat türü (pt_name), birim (um_name), ay (mp_month) ve yıl (mp_year) bulunmaktadır.

**Veri Türleri:** Veri seti, sayısal (int64, float64) ve metin (object) türlerinde veriler içermektedir.

**Eksik Veriler:** adm1_name sütununda bazı eksik veriler mevcuttur.

**Önemli Sütunlar:** Analiz için özellikle ülke, pazar, ürün, fiyat, ay ve yıl sütunları önem taşımaktadır.


```{r echo=FALSE, message=FALSE, warning=FALSE}
head(production_data)

dim(production_data)

str(production_data)

colSums(is.na(production_data))

#unique(production_data$Entity) # Ülkeler
table(production_data$Year)    # Yıllar
#summary(production_data$`Maize Production`) # Mısır Üretimi
#summary(production_data$`Rice Production`)  # Pirinç Üretimi

```


## "world food production.csv" Veri Seti Analizi

**Genel Bakış:** Toplam 11,912 satır ve 24 sütundan oluşan bu veri seti, çeşitli ülkelerdeki yıllık tarım ürünleri üretim miktarlarını içermektedir.
    
**Veri Türleri:** Bu veri seti de sayısal (int64, float64) ve metin (object) türlerinde veriler içermektedir.
    
**Eksik Veriler:** Veri setinde eksik veri bulunmamaktadır.
    
**Önemli Sütunlar:** Ülke (Entity), yıl (Year) ve çeşitli tarım ürünlerinin üretim miktarları (örneğin, Maize Production, Rice Production) analiz için kritik öneme sahiptir.

# Q4 : Veri seti ön işlemesi

Veri setlerinin analize hazır hale getirilmesi için gerçekleştirilen önemli ön işleme adımları aşağıda özetlenmiştir:


```{r echo=FALSE, message=FALSE, warning=FALSE}
# Gerekli kütüphanelerin yüklenmesi
library(dplyr)

# 'wfp_market_food_prices.csv' için Faktör Dönüşümü
prices_data$adm0_name <- as.factor(prices_data$adm0_name)
prices_data$mkt_name <- as.factor(prices_data$mkt_name)
prices_data$cm_name <- as.factor(prices_data$cm_name)

# Sayısal Değer Düzeltmesi
prices_data$mp_price <- as.numeric(gsub(",", ".", prices_data$mp_price))

# Eksik Veri Düzenlemesi
prices_data[prices_data == -999] <- NA
prices_data[prices_data == "yok"] <- NA
production_data[production_data == -999] <- NA
production_data[production_data == "yok"] <- NA

# NA Değerlerinin Temizlenmesi
prices_data <- na.omit(prices_data)
production_data <- na.omit(production_data)

# Veri Dönüşümü (Para Birimi Dönüşümü)
# Bu kısım, döviz kurlarına bağlıdır ve örnek bir dönüşüm işlemi içerir.
 exchange_rates <- c(USD_TRY = 30, EUR_TRY = 30) # Örnek döviz kurları
 prices_data$mp_price_TRY <- prices_data$mp_price * exchange_rates[paste(prices_data$cur_name, "TRY", sep = "_")]

# Ön işlemesi tamamlanmış veri setlerinden örnek satırların gösterilmesi
head(prices_data)
head(production_data)

```
**Faktör Dönüşümü:** 'wfp_market_food_prices.csv' veri setindeki kategori bilgisi içeren sütunlar (örneğin, 'adm0_name', 'mkt_name', 'cm_name') faktör tipine dönüştürülmüştür. Bu dönüşüm, R'da bu verilerden daha etkin bir şekilde faydalanabilmemizi sağlamıştır.

**Sayısal Değer Düzeltmesi:** Bazı sayısal değerlerin ondalık ayracı virgül olarak belirtilmişti. Bu veriler, analizde doğru şekilde işlenebilmesi için nokta kullanılarak düzeltilmiştir.

**Eksik Veri Düzenlemesi:** Her iki veri setinde de eksik veriler farklı şekillerde belirtilmişti (örneğin, -999, "yok"). Bu eksik değerler, R'ın anlayabileceği NA formatına dönüştürülmüştür. Örneğin, 'wfp_market_food_prices.csv' veri setinde toplam 66 eksik değer bulunmaktaydı ve bu değerler temizleme işlemi sonrasında NA ile değiştirilmiştir.

**NA Değerlerinin Temizlenmesi:** Analizde kullanılacak olan sütunlardaki NA değerleri temizlenmiştir. Bu işlem, veri setinin bütünlüğünü korurken aynı zamanda analizin doğruluğunu artırmıştır.

**Veri Dönüşümü:** Projede kullanılacak olan bazı verilerin, analizin gereksinimlerine uygun hale getirilmesi için dönüşüm işlemleri yapılmıştır. Örneğin, 'wfp_market_food_prices.csv' veri setindeki fiyatlar farklı para birimlerinde olduğundan, bunlar ortak bir para birimi ( TRY) cinsinden ifade edilmiştir.

Bu ön işleme adımları, ham verilerin analiz için uygun ve anlamlı bir hale getirilmesini sağlamıştır. Bu ön işleme adımları sayesinde, veri setleri sonraki analiz aşamalarına hazır hale getirilmiştir.

# Q5 : Veri mühendisliği 

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Veri setlerini 'Ülke' ve 'Yıl' sütunlarına göre birleştirme
combined_data <- merge(prices_data, production_data, by.x = c("adm0_name", "mp_year"), by.y = c("Entity", "Year"))
```

Projemizde "wfp_market_food_prices.csv" ve "world food production.csv" olmak üzere iki farklı veri seti kullanılmıştır. Bu iki veri setini birleştirmek suretiyle, daha kapsamlı bir analiz yapabilme imkanı oluşturduk. Birleştirme işlemi, her iki veri setinde de ortak olan 'Ülke' ve 'Yıl' sütunları kullanılarak yapılmıştır. Bu işlem, farklı kaynaklardan elde edilen verileri bir araya getirerek, ülkelerin tarım ürünleri üretimi ve pazar fiyatları arasındaki ilişkileri daha iyi anlamamıza olanak tanımaktadır.
Birleştirilmiş veri setinden örnek olarak aşağıda birkaç satır gösterilmektedir:

Bu birleşik veri seti üzerinde basit analizler gerçekleştirilmiştir. Örnek olarak:

**Grafik Çizimi:** 'Maize Production (tonnes)' ve 'Wheat Production (tonnes)' sütunları için yıllara göre üretim miktarlarını gösteren bir zaman serisi grafiği çizilmiştir. Bu grafik, belirli tarım ürünlerinin üretim eğilimlerini görselleştirmemizi sağlamaktadır.


```{r echo=FALSE, message=FALSE, warning=FALSE}
# Veri setlerini 'Ülke' ve 'Yıl' sütunlarına göre birleştirme
combined_data <- merge(prices_data, production_data, by.x = c("adm0_name", "mp_year"), by.y = c("Entity", "Year"))
#head(combined_data)
# Grafik kütüphanesini yükleme
library(ggplot2)

# 'Maize Production (tonnes)' ve 'Wheat Production (tonnes)' için zaman serisi grafiği
ggplot(combined_data, aes(x = mp_year)) +
  geom_line(aes(y = `Maize Production (tonnes)`, colour = "Maize")) +
  geom_line(aes(y = `Wheat Production (tonnes)`, colour = "Wheat")) +
  labs(title = "Yıllara Göre Mısır ve Buğday Üretimi", x = "Yıl", y = "Üretim (ton)") +
  theme_minimal()
```

**Ortalama ve Medyan Hesaplamaları:** Birleşik veri setindeki çeşitli tarım ürünlerinin yıllık ortalama ve medyan üretim miktarları hesaplanmıştır. Bu istatistikler, ürünlerin zaman içindeki üretim değişimlerini analiz etmek için kullanılmıştır.


```{r echo=FALSE, message=FALSE, warning=FALSE}
     # Çeşitli tarım ürünlerinin yıllık ortalama ve medyan üretim miktarları
mean_maize_production <- mean(combined_data$`Maize Production (tonnes)`, na.rm = TRUE)
median_maize_production <- median(combined_data$`Maize Production (tonnes)`, na.rm = TRUE)
mean_rice_production <- mean(combined_data$`Rice Production (tonnes)`, na.rm = TRUE)
median_rice_production <- median(combined_data$`Rice Production (tonnes)`, na.rm = TRUE)

```

**Kategorilere Ayırma:** Veriler, üretim miktarına göre çeşitli kategorilere ayrılarak, her kategorideki ülkelerin üretim performansları karşılaştırılmıştır.
Bu adımlar, veri setlerini daha derinlemesine analiz etmek ve yatırım stratejileri geliştirmek için önemli bir temel oluşturmaktadır.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Üretim miktarına göre kategorilere ayırma ve ülkelerin üretim performanslarını karşılaştırma
# Örnek olarak 'Maize Production (tonnes)' için kategorilere ayırma
combined_data$maize_production_category <- cut(combined_data$`Maize Production (tonnes)`, breaks = quantile(combined_data$`Maize Production (tonnes)`, na.rm = TRUE), include.lowest = TRUE, labels = FALSE)

```


